
@import models.entities.KbjCategory
@(rootCates: List[KbjCategory], bargainCates: LinkedHashMap[KbjCategory, List[KbjCategory]], hotProductL: List[String], keyWord: String)

@main() {
  @header.render(hotProductL, keyWord)
  <div class="container home-container">
    <div class="row home-row">
      <div class="col-md-3 col-sm-3 col-xs-3 column home-row2">
        <div class="row clearfix home-col3">
          <ul id="menu">
          @for((rootCate, idx) <- rootCates.zipWithIndex) {
            <li id="cate@idx" style="height: 45px">
              <a>
                <div class="row">
                  <i class="glyphicon glyphicon-align-left col-md-1 col-sm-1 col-xs-1" aria-hidden="true"></i>
                  <input type="hidden" id="rootId@idx" value="@rootCate.id">
                  <span class="col-md-8 col-sm-8 col-xs-8">@rootCate.name</span>
                  <i class="glyphicon glyphicon-menu-right col-sm-1 col-xs-1 col-md-1" aria-hidden="true"></i>
                </div>
              </a>
            </li>
          }
          </ul>
        </div>
      </div>

      <div class="col-md-9 col-sm-9 col-xs-9 home-col9 column">
        <div class="row">
          @*图片轮播放*@
          <div class="col-md-9 col-sm-9 col-xs-9 home-col26 column">
            <div class="flexslider">
              <ul class="slider-content slides">
                <li class="image">
                  <img src="http://c.hiphotos.baidu.com/zhidao/wh%3D450%2C600/sign=aed7bfd496eef01f4d4110c1d5ceb513/1b4c510fd9f9d72a7a0116add62a2834349bbb1c.jpg" style="height:300px"/>
                </li>
                <li class="image">
                  <img src="http://i.weather.com.cn/images/cn/life/2013/10/20/67CC0195C767B1184EC42DA285815C06.jpg" style="height:300px"/>
                </li>
                <li class="image">
                  <img src="http://g.hiphotos.baidu.com/zhidao/pic/item/728da9773912b31b9e4022e88718367adbb4e1c7.jpg" style="height:300px"/>
                </li>
              </ul>
            </div>
          </div>
          @*登录模块*@
          <div class="col-md-3 col-sm-3 col-xs-3 home-col23 column">
            <div class="login-all">
              <div class="row login-image">
                <div class="col-md-2 col-xs-2 col-sm-2">
                  <img src="http://bbs.manmanbuy.com/images/face/none.gif">
                </div>
                <div class="login-hello">HI, 欢迎来到可比价!</div>
                <div class="col-md-1 col-xs-1 col-sm-1 login-login">登录</div>
                <div class="col-md-1 col-xs-1 col-sm-1 login-register">注册</div>
              </div>
              <div class="login-concern">您最近关注的商品</div>
              <div class="row login-border-top">
                <div class="col-md-6 login-border">
                  <img src="http://img10.360buyimg.com/n0/jfs/t1531/29/501435053/267248/16a16a0c/558a63fcNc8b1a857.jpg" class="login-concern-img">
                  <li class="login-list">SUPER MILD 惠润...</li>
                </div>
                <div class="col-md-6 login-concern-imgs">
                  <img src="http://www.yiteng365.com/photos/65317_6.jpg?" class="login-concern-img">
                  <li class="login-list">SUPER MILD 惠润...</li>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    @*今日超值推荐模块*@
    @*<div class="row" style="padding-left: 50px">
      <h1>今日超值推荐</h1>
    </div>*@
    <div class="row clearfix home-row3">
      <div class="col-sm-1 col-md-1 col-xs-1" style="padding: 0px">
        <ul class="nav nav-pills nav-stacked left-fixed">
          <li role="presentation"><a style="background-color: blueviolet; color: #FFFFFF; font-weight: bolder">超值推荐</a></li>

          @for((parent, children) <- bargainCates) {
            <li role="presentation" id="@parent.id"><a href="#">@parent.name</a></li>
          }
          @*
          <li role="presentation" class="active"><a href="#">电脑配件</a></li>
          <li role="presentation"><a href="#">户外运动</a></li>
          <li role="presentation"><a href="#">生鲜水果</a></li>
          <li role="presentation"><a href="#">影音视听</a></li>
          <li role="presentation"><a href="#">办公网络</a></li>
          *@
        </ul>
      </div>
      @for(((parent, children),index) <- bargainCates.zipWithIndex) {
      <div class="row product-detail" id="parent@parent.id">
        <div class="row product-row1">
          <ul class="nav nav-tabs leaf-nav">
            <li class="pull-left" style="width: 200px; height: 42px"><h3>@parent.name</h3></li>
            @if(index < 2) {
              @for((child, idx) <- children.zipWithIndex) {
                <li role="presentation" id="child@child.id" data-id="@child.id" data-parent="@parent.id" @if((idx+1) == 5) {class="active"}><a href="#">@child.name</a></li>
              }
            }
            @*<li role="presentation" class="active"><a href="#">全部</a></li>    *@
          </ul>
        </div>

        @*<div class="product-spacer"></div>*@
        <div class="row product-row2">
          <div class="row product-row21" id="product_detail">
            @*
          @for(homeProduct <- bargainCates){
            <div class="col-sm-3 col-md-3 col-xs-3 product-sm3" onclick="location.href='/product/detail'">
              <div class="product-image">
                <a><img class="row" src="@homeProduct.get("img")" /></a>
              </div>
              <div class="product-comment">
                <a><i class="glyphicon glyphicon-comment">@homeProduct.get("comment")</i></a>
                <a><i class="glyphicon glyphicon-thumbs-up">@homeProduct.get("support")</i></a>
                <a><i class="glyphicon glyphicon-thumbs-down">@homeProduct.get("nonsupport")</i></a>
              </div>
              <div class="product-title">
                <a><font>@homeProduct.get("title")</font></a>
              </div>
              <div class="product-price">
                <font>@homeProduct.get("price")</font>
              </div>
              <div class="product-platform">
                <font class="pull-left">@homeProduct.get("platform")</font>
                <font class="pull-right">@homeProduct.get("time")</font>
              </div>
            </div>
          }*@
          </div>
        </div>
      </div>
      }
    </div>

    <script type="text/javascript">
      $(document).ready(function() {
        //轮播图
        $('.flexslider').flexslider({
          //参数设置在这里
          animation: "slide",//使用滑动效果
          slideshowSpeed: 2300,//切换速度
          directionNav: false,
          after:function(slider){//加载完成后回调函数
            //console.log(slider)
          }
        });

        //取子类数据
        $("[id^='rootId']").each(function(idx) {
         var rootId = $(this).val();
          $.ajax({
            type: "get",
            url:  "/home/root/cate/" + rootId,
            dataType: "json",
            success: function(data) {
              var leafCateId = "leafCate" + idx;
              $("#cate" + idx).append("<div class='row home-row34' id='" + leafCateId + "'</div>");
              for (var i = 0; i < data.length; i++) {
                $('#leafCate' + idx).append("<a class='col-md-4 col-sm-4 col-xs-4'>" + "<span class='home-col34'>" + data[i].name + "</span>" + "</a>");
              }
            },
            error: function () {
              alert("ajax error");
            }
          })
        })

        //获取今日超值推荐商品
        $("[id^='child']").each(function(index) {
          var cate = $(this).data("id");
          $.ajax({
            type: "get",
            url: "/home/bargain/" + cate,
            dataType: "json",
            success: function(data) {
//              alert(data.length);
              for (var i = 0; i < data.length; i++) {
//                alert(data[i].product.kbjCateId);
//                var detailId = "detail" + data[i].product.skuid;
//                $("#product_detail").append("<div class='col-sm-3 col-md-3 col-xs-3 product-sm3'></div>");
//
              }
            },
            error: function() {
              console.log("error");
            }
          })
        })

      });

      $('.arrow.left').click(function(){
        $('.flex-prev').click();
      });
      $('.arrow.right').click(function(){
        $('.flex-next').click();
      });




    </script>
  </div>
  @footer.render()
}